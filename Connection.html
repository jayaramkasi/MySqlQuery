<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <input type="text" id="serverIp" placeholder="Enter server IP "><br>
    <input type="number" id="sqlPort" placeholder="Enter sql Port "><br>
    <input type="text" id="sqlUser" placeholder="Enter sql User"><br>
    <input type="password" id="sqlPassword" placeholder="Enter sql password"><br>
    <input type="text" id="sqlDB" placeholder="Enter sql Database name"><br>    
    <button onClick = "updateUserPrefs();">Update</button>
  </body>
  <script>
    google.script.run.withSuccessHandler(setPrefs).getUserProperties();
    function setPrefs(userPrefs){
     document.getElementById("serverIp").value = userPrefs.serverIp;
     document.getElementById("sqlPort").value = userPrefs.sqlPort;
     document.getElementById("sqlUser").value = userPrefs.sqlUser;
     document.getElementById("sqlPassword").value = userPrefs.sqlPassword;
     document.getElementById("sqlDB").value = userPrefs.sqlDB;
    }
    function updateUserPrefs(){
      var connectionProperties = {
        "serverIp": document.getElementById("serverIp").value,
        "sqlPort": document.getElementById("sqlPort").value,
        "sqlUser": document.getElementById("sqlUser").value,
        "sqlPassword": document.getElementById("sqlPassword").value,
        "sqlDB": document.getElementById("sqlDB").value
      };
      google.script.run.withSuccessHandler(updateSuccess).setUserProperties(connectionProperties);
    }
    function updateSuccess(){
        alert("Update success");
    }
  </script>
</html>


